<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" class="h-full" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D,%22class%22:%7B%22ssr%22:%22h-full%22%7D%7D">
  <head>
    <title>Autodydaktycznie. Blog o technologiach webowych i IT | Julia Glaszka</title><meta name="gridsome:hash" content="d33f7f3abd897bc488323552c61cecc69d4cb3d2"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="theme-color" content="#261447"><meta data-vue-tag="ssr" name="msapplication-navbutton-color" content="#261447"><meta data-vue-tag="ssr" name="apple-mobile-web-app-status-bar-style" content="#261447"><meta data-vue-tag="ssr" name="viewport" content="width=device-width"><meta data-vue-tag="ssr" data-key="description" name="description" content="Blog o moich samodzielnych zmaganiach z nauką z różnych dziedzin IT. "><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.34768914d4a101067dd64a8f857ab22c.png"><link rel="preload" href="/assets/css/0.styles.e86ef555.css" as="style"><link rel="preload" href="/assets/js/app.6515d007.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.7bb06337.js" as="script"><link rel="prefetch" href="/assets/js/8.82dc9478.js"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.efb276f1.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.fe0b8de3.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue~page--src--templates--tag-vue.cd68e303.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.81ad7c4a.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--index-vue~page--src--templates--post-vue~page--src--templates--tag-vue.9318dd70.js"><link rel="stylesheet" href="/assets/css/0.styles.e86ef555.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body class="antialiased font-serif" data-vue-tag="%7B%22class%22:%7B%22ssr%22:%22antialiased%20font-serif%22%7D%7D">
    <div data-server-rendered="true" id="app" class="bg-white"><nav class="navbar"><div class="navbar-brand container has-text-centered"><a href="/" class="navbar-item has-text-weight-semibold has-text-black-bis	">✨ Julia Glaszka ✨</a></div></nav><header class="is-halfheight" data-v-b236c61e><section class="section" style="height:100%;background-image:linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url(/images/posts/kopie/cover.jpg);background-position:center;background-size:cover;" data-v-b236c61e><div class="container" data-v-b236c61e><div data-v-b236c61e><h5 class="has-text-6 is-uppercase has-text-white" data-v-b236c61e>
              4 min czytania
            </h5><h1 class="title is-size-2 p-t-md has-text-white" data-v-b236c61e>
              Wykonywanie kopii obiektów w JavaScript
            </h1><h2 class="subtitle p-t-md has-text-white" data-v-b236c61e><span data-v-b236c61e><a href="/undefined/" class="has-text-white">
                  Julia Glaszka</a> •
              </span><time datetime="2020-03-01 14:43:24" class="capitalize" data-v-b236c61e>01 marca, 2020</time></h2><nav class="container"><a href="/" class="has-text-white active">
      ← Powrót
    </a></nav></div></div></section></header><div class="container"><section class="section"><div class="columns mt-5"><div class="column is-three-quarters"><div class="container	"><div class="is-three-fifths-tablet post"><div role="alert" class="leading-normal p-4 md:mx-6 mb-12 notification">
                Ten post ma ponad rok, może być nieaktualny.
              </div><div class="content has-text-justified"><p><strong>Kopiowanie</strong> to mechanizm tworzenia <strong>duplikatów</strong>. W przypadku <strong>prymitywów</strong> (string, number, boolean itd) sprawa jest prosta, możemy spokojnie wykonywać wszystkie operacje bez obaw o nadpisywanie oryginału. </p>
<p>Sprawa się komplikuje przy zastosowaniu przypisania obiektu za pomocą prostego = - wtedy tworzy się <strong>referencja</strong> do oryginału. Kopia jest zależna od oryginału, więc każda modyfikacja w obiekcie oddziałuje na resztę obiektów. Czasami taki efekt nie jest pożądany, niestety w js brakuje natywnych, prostych sposobów na klonowanie obiektów bez tworzenia referencji (wskaźnika na oryginał), trzeba w tym celu wykorzystywać różne hacki. </p>
<p>W tym artykule omówię część z nich, mam nadzieję że komuś się przydadzą.</p>
<h2 id="trochę-teorii">Trochę teorii</h2>
<p>Istnieją rodzaje kopiowania obiektów w js:</p>
<ul>
<li><strong>Brak</strong> - <strong>referencja</strong>, wskazuje na adres obiektu macierzystego. Przy podmianie jakiejkolwiek wartości obiektu, zamieniają się one równocześnie w kopii i oryginale. Kopia jest <strong>silnie zależna</strong> od oryginału.</li>
<li><strong>Płytkie (shallow)</strong> - otrzymujemy prostą kopię, która posiada <strong>jednopoziomową kopię</strong>, głębsze zagnieżdzenia są <strong>referencją do oryginału</strong> i przy podmianie wartości zmieni się również w innych obiektach.</li>
<li><strong>Głębokie (deep)</strong> - kopie są <strong>identyczne</strong> i <strong>niezależne</strong> od siebie. Obiekt jest <strong>autonomiczny</strong>, posiada wartości na własność, <strong>nic nie współdzieli</strong> - zmiana w oryginale nie zmodyfikuje kopii.</li>
</ul>
<h2 id="brak-kopii">Brak kopii</h2>
<p>Zacznijmy od tego, w jaki sposób nie skopiujemy obiektu, a który jednak początkowo wydaje się słusznym i prostym rozwiązaniem. Jak widać, przy podmianie wartości w klonie, wartość oryginału również się zmieniła, co nie jest oczekiwanym efektem.</p>
<pre class="shiki" style="background-color: #000c18"><code><span style="color: #223355">// proste przypisanie  </span>
<span style="color: #9966B8">var</span><span style="color: #6688CC"> strawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> {</span>
<span style="color: #6688CC">    color: </span><span style="color: #22AA44">'red'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    taste: </span><span style="color: #22AA44">'sweet'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    size: </span><span style="color: #22AA44">'large'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    shape: {</span>
<span style="color: #6688CC">        x: </span><span style="color: #F280D0">10</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">        y: </span><span style="color: #F280D0">32</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">        z: </span><span style="color: #F280D0">33</span>
<span style="color: #6688CC">    }</span>
<span style="color: #6688CC">};</span>

<span style="color: #9966B8">var</span><span style="color: #6688CC"> someOtherStrawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> strawberry;</span>
<span style="color: #6688CC">someOtherStrawberry.size </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #22AA44">'small'</span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.size); </span>
<span style="color: #223355">// output: small</span></code></pre>
<h2 id="płytkie-kopie">Płytkie kopie</h2>
<p>Część funkcji dostarczonych <strong>natywnie</strong> przez JavaScript umożliwia <strong>płytkie skopiowanie</strong> obiektu. Dopóki zajmujemy się przestrzenią bez zagnieżdżeń, wszystko działa jak powinno. </p>
<p><strong>Problem</strong> pojawia się, gdy <strong>modyfikujemy zagnieżdżone obiekty</strong> - wtedy nadal możemy <strong>modyfikować oryginał</strong>, co nie jest pożądane (dzięki rekurencyjnemu użyciu płytkich kopii możemy jednak stworzyć głęboką kopię, czym zajmiemy się później). </p>
<p>Poniżej sposób na płytką kopię: </p>
<h3 id="objectassign">Object.assign()</h3>
<pre class="shiki" style="background-color: #000c18"><code><span style="color: #223355">//Tworzy płytką kopię - klonuje właściwości najwyższego poziomu, pozostawiając referencję do zagnieżdzonych  </span>
<span style="color: #9966B8">var</span><span style="color: #6688CC"> someOtherStrawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #9966B8">Object</span><span style="color: #6688CC">.</span><span style="color: #DDBB88">assign</span><span style="color: #6688CC">({}, strawberry);  </span>
<span style="color: #6688CC">someOtherStrawberry.size </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #22AA44">'small'</span><span style="color: #6688CC">;  </span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.size) </span>
<span style="color: #223355">// output: large  </span>

<span style="color: #6688CC">someOtherStrawberry.shape.x </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #F280D0">32</span><span style="color: #6688CC">  </span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.shape.x) </span>
<span style="color: #223355">// output: 32, wartość strawberry jest podmieniona przez modyfikacje na someOtherStrawberry!</span></code></pre>
<h3 id="spread-operator-es6">Spread operator ES6</h3>
<p>Standard ES6 przynosi nam proste ułatwienia, pozwalające na dokonywanie kopii. Jednym z nich jest <strong>spread operator</strong> <code>...</code>, który <strong>płytko ignoruje</strong> wskaźnik do obiektu <strong>macierzystego</strong>. Dzięki temu otrzymujemy obiekty niezależne.</p>
<pre class="shiki" style="background-color: #000c18"><code><span style="color: #9966B8">var</span><span style="color: #6688CC"> strawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> {</span>
<span style="color: #6688CC">    color: </span><span style="color: #22AA44">'red'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    taste: </span><span style="color: #22AA44">'sweet'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    size: </span><span style="color: #22AA44">'large'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    shape: {</span>
<span style="color: #6688CC">        x: </span><span style="color: #F280D0">10</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">        y: </span><span style="color: #F280D0">32</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">        z: </span><span style="color: #F280D0">33</span>
<span style="color: #6688CC">    }</span>
<span style="color: #6688CC">};</span>
<span style="color: #9966B8">const</span><span style="color: #6688CC"> someOtherStrawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> {</span>
<span style="color: #6688CC">    </span><span style="color: #225588">...</span><span style="color: #6688CC">strawberry</span>
<span style="color: #6688CC">};</span>
<span style="color: #6688CC">someOtherStrawberry.size </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #22AA44">'small'</span><span style="color: #6688CC">;</span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.size) </span>
<span style="color: #223355">// output: large, wszystko OK!  </span>

<span style="color: #6688CC">someOtherStrawberry.shape.x </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #F280D0">32</span><span style="color: #6688CC">;</span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.shape.x) </span>
<span style="color: #223355">// output: 32, znowu podmienione przez modyfikacje na someOtherStrawberry :(</span></code></pre>
<h2 id="sposoby-na-głęboką-kopię">Sposoby na głęboką kopię</h2>
<h3 id="jsonparse-jsonstringify">JSON.parse(), JSON.stringify()</h3>
<p>Kiedy tworzymy klona, chcielibyśmy by był całkowicie <strong>niezależny referencyjnie</strong> od oryginału, a jednocześnie był identyczny jak on. Łatwo można to uzyskać za pomocą niezbyt eleganckiej sztuczki z JSONem. Metoda ta działa tylko z <strong>strukturami danych</strong> - obiekt w tym wypadku nie może zawierać funkcji. </p>
<p>Osobiście <strong>nie stosowałabym</strong> tego sposobu - w przypadku gdy przy wstępnych założeniach obiekt jest zwykłą strukturą danych, a później nieświadomy inny programista dopisze do niego metody, pojawi się nieoczekiwany i problematyczny bug.</p>
<pre class="shiki" style="background-color: #000c18"><code><span style="color: #9966B8">var</span><span style="color: #6688CC"> strawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> {</span>
<span style="color: #6688CC">    color: </span><span style="color: #22AA44">'red'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    taste: </span><span style="color: #22AA44">'sweet'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    size: </span><span style="color: #22AA44">'large'</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">    shape: {</span>
<span style="color: #6688CC">        x: </span><span style="color: #F280D0">10</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">        y: </span><span style="color: #F280D0">32</span><span style="color: #6688CC">,</span>
<span style="color: #6688CC">        z: </span><span style="color: #F280D0">33</span>
<span style="color: #6688CC">    }</span>
<span style="color: #6688CC">};</span>
<span style="color: #9966B8">const</span><span style="color: #6688CC"> someOtherStrawberry </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #9966B8">JSON</span><span style="color: #6688CC">.</span><span style="color: #9966B8">parse</span><span style="color: #6688CC">(</span><span style="color: #9966B8">JSON</span><span style="color: #6688CC">.</span><span style="color: #9966B8">stringify</span><span style="color: #6688CC">(strawberry));</span>
<span style="color: #6688CC">someOtherStrawberry.size </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #22AA44">'small'</span><span style="color: #6688CC">;</span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.size) </span>
<span style="color: #223355">// output: large, wszystko OK!  </span>

<span style="color: #6688CC">someOtherStrawberry.shape.x </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #F280D0">32</span><span style="color: #6688CC">;</span>
<span style="color: #9966B8">console</span><span style="color: #6688CC">.</span><span style="color: #9966B8">log</span><span style="color: #6688CC">(strawberry.shape.x) </span>
<span style="color: #223355">// output: 10, wszystko OK!</span></code></pre>
<h3 id="customowa-funkcja-do-głębokiego-kopiowania">Customowa funkcja do głębokiego kopiowania</h3>
<p>Posiadamy już narzędzia do tworzenia płytkich kopii, możemy więc je wykorzystać przy tworzeniu głębokich kopii, wystarczy <strong>rekurencyjnie</strong> przejść po wszystkich <strong>węzłach</strong>. </p>
<p>Algorytm sprawdza czy przekazana w argumencie wartość - jeśli jest <strong>prymitywem</strong>, po prostu zwraca go. W przypadku, gdy argument jest <strong>obiektem</strong>, przechodzimy po <strong>każdym</strong> jego <strong>polu</strong> i sprawdzamy czy jest ono typem <strong>prymitywnym</strong>, jeśli nie - wywołujemy funkcję "rozbijającą" dla pola nie-prymitywnego .</p>
<p>Wszystko się powtarza do momentu, gdy algorytm przejdzie po całym <strong>drzewie</strong>.</p>
<pre class="shiki" style="background-color: #000c18"><code><span style="color: #9966B8">const</span><span style="color: #6688CC"> </span><span style="color: #DDBB88">deepCopyFunc</span><span style="color: #6688CC"> </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #2277FF">child</span><span style="color: #6688CC"> </span><span style="color: #9966B8">=&gt;</span><span style="color: #6688CC"> {</span>
<span style="color: #6688CC">    </span><span style="color: #9966B8">let</span><span style="color: #6688CC"> parent, value, key</span>
<span style="color: #6688CC">    </span><span style="color: #225588">if</span><span style="color: #6688CC"> (</span><span style="color: #225588">typeof</span><span style="color: #6688CC"> child </span><span style="color: #225588">!==</span><span style="color: #6688CC"> </span><span style="color: #22AA44">"object"</span><span style="color: #6688CC"> </span><span style="color: #225588">||</span><span style="color: #6688CC"> child </span><span style="color: #225588">===</span><span style="color: #6688CC"> </span><span style="color: #F280D0">null</span><span style="color: #6688CC">) {</span>
<span style="color: #6688CC">        </span><span style="color: #225588">return</span><span style="color: #6688CC"> child </span><span style="color: #223355">// zwracamy jeśli jest typem prymitywnym  </span>
<span style="color: #6688CC">    }</span>
<span style="color: #6688CC">    parent </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #9966B8">Array</span><span style="color: #6688CC">.</span><span style="color: #DDBB88">isArray</span><span style="color: #6688CC">(child) </span><span style="color: #225588">?</span><span style="color: #6688CC"> [] </span><span style="color: #225588">:</span><span style="color: #6688CC"> {}</span>

<span style="color: #6688CC">    </span><span style="color: #223355">//jeśli jest obiektem to iterujemy po każdym property  </span>
<span style="color: #6688CC">    </span><span style="color: #225588">for</span><span style="color: #6688CC"> (key </span><span style="color: #225588">in</span><span style="color: #6688CC"> child) {</span>
<span style="color: #6688CC">        value </span><span style="color: #225588">=</span><span style="color: #6688CC"> child[key]</span>
<span style="color: #6688CC">        </span><span style="color: #223355">//jeśli wartość dla key jest obiektem to wykonujemy rekurencyjną kopie  </span>
<span style="color: #6688CC">        </span><span style="color: #225588">if</span><span style="color: #6688CC"> (value </span><span style="color: #225588">!==</span><span style="color: #6688CC"> </span><span style="color: #F280D0">null</span><span style="color: #6688CC"> </span><span style="color: #225588">&&</span><span style="color: #6688CC"> </span><span style="color: #225588">typeof</span><span style="color: #6688CC"> value </span><span style="color: #225588">===</span><span style="color: #6688CC"> </span><span style="color: #22AA44">"object"</span><span style="color: #6688CC">) {</span>
<span style="color: #6688CC">            parent[key] </span><span style="color: #225588">=</span><span style="color: #6688CC"> </span><span style="color: #DDBB88">deepCopyFunc</span><span style="color: #6688CC">(value)</span>
<span style="color: #6688CC">        } </span><span style="color: #225588">else</span><span style="color: #6688CC"> {</span>
<span style="color: #6688CC">            parent[key] </span><span style="color: #225588">=</span><span style="color: #6688CC"> value</span>
<span style="color: #6688CC">        }</span>
<span style="color: #6688CC">    }</span>
<span style="color: #6688CC">    </span><span style="color: #225588">return</span><span style="color: #6688CC"> parent</span>
<span style="color: #6688CC">}</span>

<span style="color: #9966B8">let</span><span style="color: #6688CC"> originalArray </span><span style="color: #225588">=</span><span style="color: #6688CC"> [</span><span style="color: #F280D0">37</span><span style="color: #6688CC">, </span><span style="color: #F280D0">3700</span><span style="color: #6688CC">, {</span>
<span style="color: #6688CC">    hello: </span><span style="color: #22AA44">"world"</span>
<span style="color: #6688CC">}]</span></code></pre>
<p>Myślę, że artykuł okazał się pomocny, a moje objaśnienia niezbyt trudne. Jeśli zauważysz gdzieś błąd, proszę, napisz do mnie. Zależy mi, by mój blog był rzetelnym źródłem informacji, więc z chęcią przyjmuję krytykę.</p>
</div></div></div></div><div class="column is-one-quarter"><section class="sidebar"><div class="block"><div class="has-text-centered"><div class="block sidebar-author-info"><figure class="image is-128x128 is-inline-block"><img alt="Julia Glaszka" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 1280 1280' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-57b0b776eaf0c46a5fe80435581e66b4'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-57b0b776eaf0c46a5fe80435581e66b4)' width='1280' height='1280' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCABAAEADASIAAhEBAxEB/8QAHAAAAgMBAQEBAAAAAAAAAAAABQcEBggDAQAC/8QAMxAAAQMDAwEGBAQHAAAAAAAAAQIDBAAFEQYSITEHEyJBUWEycYGRFELB0QgVIzNSobH/xAAZAQADAQEBAAAAAAAAAAAAAAABAgQDAAX/xAAfEQACAgMAAgMAAAAAAAAAAAAAAQIDERIhMUEEIjL/2gAMAwEAAhEDEQA/ANCAV1QOK/AroOlA4WXb1eV27TDERpW1UpwleD%2bVIzj7kUldCPRIt1Rcbgy46yyeVJx4VHocHr9Kun8R1yDt4hwkHIZaGR7k5/aq7pLs/k3a1Q7hvPdunftCtpwCR6HqKScko9KaYtvg8rNcbfMhofjvAoPIVVa7TtkzS1xQl1BIbKkgkZyOf0rhbrGu3adlRo7qi%2bo7ULz0OOaUl7tF3gImPSoofbO5K3HArKR5K56HPpUse%2byuS16V/T1nf1BOehxnWmTjeVOEgbQcEf8AKOXHs6uQi94l2OQ0AkpSDk88Hn6Chegp5g3sOpQFnaRtPnmmYNWPoAAhpCU8jCyDVicn4PPcV5NBpr11YbbUpRwEjJPtXyKD6zliDpa6yN2NkdeD7kY/WufgzS9GXO0m5m86plPAk73dqfYdB/rFM3R19VCtdvhzFIjsd13aFdMqHkT0H60iLjIU7LUoE7s7s%2bmaaXZvfrdeYi7XdFIalIG0hZ4X7isLk9UX0OO2GXuM9dg00w7Mtb0FKyorQT3hT7AdKDdo2qLe9o%2b4MIWkyAktkAfmrpcNN2m3NrlypTK4yBu8WE/Q460m9c6pbubibdbkIERsjctIxux0A9qwhFylwoulGEc5IGhx3mo4rROA54efWnCqxEj4k/Y0rezOD%2bL1vZGSThbwz8ua1WrTEQ4wV9efFVmTzXwsT77UZhx59xLbSElSlqOAkDzJpMdresRe7UbXYVFcdw5eeI2hYHQDPOPPpU7ti1QGprVlS7sYQgOvgdXFn4U/IDk/MelK1uQypwEOFSlHH3pLJtcQ9NafWUR1stPOhQOfX3ryzpDt0CSSCehHrR/VcdqM33zeNzvhAHl61L7LIcOZqRDMsI71SSWt3moYPH2NBzzDJooYmkFYmnnbgjvZrzyozSSrapRNKpCkvXJZTwlSlbfl5VpntFLdq0Xdn2kJQRHKEkf5K8Ix96zJbAP5pFB6FwChRlxbD8lraKRddJPO2q6Rbg1/djqyn5itSaQ1ladTw0KhyW0ysf1Iy1YWg%2bfB6isp6meEG3tojKKXCv4gecCgke%2byW1pcUhPep5DicpUPqKNeX9kJao/llw1JcHb3qabcZK9qXnVLSg9dufCPbjFRo0d1x8OIzsSQon9qEIStUxRkLygEcepqwO3RLEUNspAWU%2bHPRPufehZlD14IN/d/FTC3jwNJ2g%2b/U0EZnPWudGmxFBL8Z0OoJ6ZB8/apa3gMIHKj5%2bvNQix3ylZPTNdHiwCXR3a2uSdU9kcidASXC62lam2/EUKChuSfcc/Ss5ocLbyHEnlKgofejjN9ulvtUq0Q5a2YUtQU6hJwTgYxnyB8/XAoM42Egeas1rXDRNGNk92mHbk6JbqS4coTyfkajzUxnUITFSQoHCs1DLwLRBJHGM1Ps7ae7LijwfM0qWqHzsz/2Q==' /%3e%3c/svg%3e" width="1280" data-src="/assets/static/avatarLg.7c86909.3a4b1105ba454ab12990d76531f1ff35.jpeg" data-srcset="/assets/static/avatarLg.82a2fbd.3a4b1105ba454ab12990d76531f1ff35.jpeg 480w, /assets/static/avatarLg.7c86909.3a4b1105ba454ab12990d76531f1ff35.jpeg 1280w" data-sizes="(max-width: 1280px) 100vw, 1280px" class="is-rounded g-image g-image--lazy g-image--loading"><noscript><img src="/assets/static/avatarLg.7c86909.3a4b1105ba454ab12990d76531f1ff35.jpeg" class="is-rounded g-image g-image--loaded" width="1280" alt="Julia Glaszka"></noscript></figure><p class="title is-4 is-bold">
      Julia Glaszka
    </p><p class="subtitle is-7">
      julia.anna.glaszka@interia.pl
    </p></div><div class="content"><p> Pasjonuję się IT, ekonomią i muzyką. 
    Moim ulubionym językiem jest Java i w niej pracuję na codzień. </p></div></div></div><hr><div class="block has-text-centered"><p class="title is-4"> Tagi </p><div class="tags is-justify-content-center"><a href="/tag/javascript/" class="tag is-link is-rounded">
    #Javascript
  </a><a href="/tag/programowanie/" class="tag is-link is-rounded">
    #Programowanie
  </a></div></div><hr><div class="block "><p class="title is-4 has-text-centered"> Najnowsze posty</p><div class="column"><div class="card" style="height: 100%"><div class="card-image p-0"><a href="/obiektywizm-a-rozwoj-w-it/"><img alt="Post cover photo" src="/images/posts/obiektywizm/atlas.jpg" class="g-image"></a></div><div class="card-content"><h5 class="title is-size-4 has-padding-bottom-10 "><a href="/obiektywizm-a-rozwoj-w-it/">Obiektywizm a rozwój w IT</a></h5><!----><!----></div><!----><footer class="card-footer"><a href="/obiektywizm-a-rozwoj-w-it/" class="card-footer-item">Przeczytaj</a></footer></div></div><div class="column"><div class="card" style="height: 100%"><div class="card-image p-0"><a href="/wykorzystaj-caly-potencjal-klastra-mongo-db-z-pomoca-preferencji-odczytu/"><img alt="Post cover photo" src="/images/posts/mongodb-read-preferences/route.jpg" class="g-image"></a></div><div class="card-content"><h5 class="title is-size-4 has-padding-bottom-10 "><a href="/wykorzystaj-caly-potencjal-klastra-mongo-db-z-pomoca-preferencji-odczytu/">Wykorzystaj cały potencjał klastra MongoDB z pomocą preferencji odczytu</a></h5><!----><!----></div><!----><footer class="card-footer"><a href="/wykorzystaj-caly-potencjal-klastra-mongo-db-z-pomoca-preferencji-odczytu/" class="card-footer-item">Przeczytaj</a></footer></div></div><div class="column"><div class="card" style="height: 100%"><div class="card-image p-0"><a href="/konfiguracja-cluster-settings-w-mongo-db-java-driver/"><img alt="Post cover photo" src="/images/posts/cluster-settings-mongo/local-threshold.png" class="g-image"></a></div><div class="card-content"><h5 class="title is-size-4 has-padding-bottom-10 "><a href="/konfiguracja-cluster-settings-w-mongo-db-java-driver/">Konfiguracja ClusterSettings w MongoDB Java Driver</a></h5><!----><!----></div><!----><footer class="card-footer"><a href="/konfiguracja-cluster-settings-w-mongo-db-java-driver/" class="card-footer-item">Przeczytaj</a></footer></div></div></div></section></div></div></section><div></div></div><div class="columns"><div class="column is-full"><footer class="footer has-background-primary p-t-xl"><div class="container"><div class="columns"><div class="column has-text-left"><a href="#" class="title is-4 has-text-grey">Autodydaktycznie Blog</a><br><p class="pt-5"> 
            Wynalazca to człowiek, który pyta wszechświat: &quot;Dlaczego?&quot; 
            i nie pozwala,
            by cokolwiek stanęło między odpowiedzią 
            a jego umysłem. ~ &quot;Atlas Shrugged&quot;, Ayn Rand</p><p class="pt-1"><a href="https://www.linkedin.com/in/julia-glaszka/" target="_blank" rel="noopener" class="has-text-grey mt-5">LinkedIn</a></p></div><div class="column has-text-centered has-text-right-tablet"><p class="subtitle is-5"><span class="copyleft">©</span> juliagl</p></div></div></div></footer></div></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Wykonywanie kopii obiektów w JavaScript","path":"\u002Fwykonywanie-kopii-obiektow-w-java-script\u002F","slug":"wykonywanie-kopii-obiektow-w-js","datetime":"2020-03-01 14:43:24","content":"\u003Cp\u003E\u003Cstrong\u003EKopiowanie\u003C\u002Fstrong\u003E to mechanizm tworzenia \u003Cstrong\u003Eduplikatów\u003C\u002Fstrong\u003E. W przypadku \u003Cstrong\u003Eprymitywów\u003C\u002Fstrong\u003E (string, number, boolean itd) sprawa jest prosta, możemy spokojnie wykonywać wszystkie operacje bez obaw o nadpisywanie oryginału. \u003C\u002Fp\u003E\n\u003Cp\u003ESprawa się komplikuje przy zastosowaniu przypisania obiektu za pomocą prostego = - wtedy tworzy się \u003Cstrong\u003Ereferencja\u003C\u002Fstrong\u003E do oryginału. Kopia jest zależna od oryginału, więc każda modyfikacja w obiekcie oddziałuje na resztę obiektów. Czasami taki efekt nie jest pożądany, niestety w js brakuje natywnych, prostych sposobów na klonowanie obiektów bez tworzenia referencji (wskaźnika na oryginał), trzeba w tym celu wykorzystywać różne hacki. \u003C\u002Fp\u003E\n\u003Cp\u003EW tym artykule omówię część z nich, mam nadzieję że komuś się przydadzą.\u003C\u002Fp\u003E\n\u003Ch2 id=\"trochę-teorii\"\u003ETrochę teorii\u003C\u002Fh2\u003E\n\u003Cp\u003EIstnieją rodzaje kopiowania obiektów w js:\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003EBrak\u003C\u002Fstrong\u003E - \u003Cstrong\u003Ereferencja\u003C\u002Fstrong\u003E, wskazuje na adres obiektu macierzystego. Przy podmianie jakiejkolwiek wartości obiektu, zamieniają się one równocześnie w kopii i oryginale. Kopia jest \u003Cstrong\u003Esilnie zależna\u003C\u002Fstrong\u003E od oryginału.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EPłytkie (shallow)\u003C\u002Fstrong\u003E - otrzymujemy prostą kopię, która posiada \u003Cstrong\u003Ejednopoziomową kopię\u003C\u002Fstrong\u003E, głębsze zagnieżdzenia są \u003Cstrong\u003Ereferencją do oryginału\u003C\u002Fstrong\u003E i przy podmianie wartości zmieni się również w innych obiektach.\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Cstrong\u003EGłębokie (deep)\u003C\u002Fstrong\u003E - kopie są \u003Cstrong\u003Eidentyczne\u003C\u002Fstrong\u003E i \u003Cstrong\u003Eniezależne\u003C\u002Fstrong\u003E od siebie. Obiekt jest \u003Cstrong\u003Eautonomiczny\u003C\u002Fstrong\u003E, posiada wartości na własność, \u003Cstrong\u003Enic nie współdzieli\u003C\u002Fstrong\u003E - zmiana w oryginale nie zmodyfikuje kopii.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"brak-kopii\"\u003EBrak kopii\u003C\u002Fh2\u003E\n\u003Cp\u003EZacznijmy od tego, w jaki sposób nie skopiujemy obiektu, a który jednak początkowo wydaje się słusznym i prostym rozwiązaniem. Jak widać, przy podmianie wartości w klonie, wartość oryginału również się zmieniła, co nie jest oczekiwanym efektem.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #000c18\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F proste przypisanie  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Evar\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E strawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    color: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'red'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    taste: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'sweet'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    size: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'large'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    shape: {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        x: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E10\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        y: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E32\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        z: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E33\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    }\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E};\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #9966B8\"\u003Evar\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E someOtherStrawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E strawberry;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.size \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'small'\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.size); \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: small\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"płytkie-kopie\"\u003EPłytkie kopie\u003C\u002Fh2\u003E\n\u003Cp\u003ECzęść funkcji dostarczonych \u003Cstrong\u003Enatywnie\u003C\u002Fstrong\u003E przez JavaScript umożliwia \u003Cstrong\u003Epłytkie skopiowanie\u003C\u002Fstrong\u003E obiektu. Dopóki zajmujemy się przestrzenią bez zagnieżdżeń, wszystko działa jak powinno. \u003C\u002Fp\u003E\n\u003Cp\u003E\u003Cstrong\u003EProblem\u003C\u002Fstrong\u003E pojawia się, gdy \u003Cstrong\u003Emodyfikujemy zagnieżdżone obiekty\u003C\u002Fstrong\u003E - wtedy nadal możemy \u003Cstrong\u003Emodyfikować oryginał\u003C\u002Fstrong\u003E, co nie jest pożądane (dzięki rekurencyjnemu użyciu płytkich kopii możemy jednak stworzyć głęboką kopię, czym zajmiemy się później). \u003C\u002Fp\u003E\n\u003Cp\u003EPoniżej sposób na płytką kopię: \u003C\u002Fp\u003E\n\u003Ch3 id=\"objectassign\"\u003EObject.assign()\u003C\u002Fh3\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #000c18\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #223355\"\u003E\u002F\u002FTworzy płytką kopię - klonuje właściwości najwyższego poziomu, pozostawiając referencję do zagnieżdzonych  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Evar\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E someOtherStrawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003EObject\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #DDBB88\"\u003Eassign\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E({}, strawberry);  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.size \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'small'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E;  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.size) \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: large  \u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.shape.x \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E32\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.shape.x) \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: 32, wartość strawberry jest podmieniona przez modyfikacje na someOtherStrawberry!\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"spread-operator-es6\"\u003ESpread operator ES6\u003C\u002Fh3\u003E\n\u003Cp\u003EStandard ES6 przynosi nam proste ułatwienia, pozwalające na dokonywanie kopii. Jednym z nich jest \u003Cstrong\u003Espread operator\u003C\u002Fstrong\u003E \u003Ccode\u003E...\u003C\u002Fcode\u003E, który \u003Cstrong\u003Epłytko ignoruje\u003C\u002Fstrong\u003E wskaźnik do obiektu \u003Cstrong\u003Emacierzystego\u003C\u002Fstrong\u003E. Dzięki temu otrzymujemy obiekty niezależne.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #000c18\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #9966B8\"\u003Evar\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E strawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    color: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'red'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    taste: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'sweet'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    size: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'large'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    shape: {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        x: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E10\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        y: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E32\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        z: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E33\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    }\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E};\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econst\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E someOtherStrawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E...\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003Estrawberry\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E};\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.size \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'small'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.size) \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: large, wszystko OK!  \u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.shape.x \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E32\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.shape.x) \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: 32, znowu podmienione przez modyfikacje na someOtherStrawberry :(\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2 id=\"sposoby-na-głęboką-kopię\"\u003ESposoby na głęboką kopię\u003C\u002Fh2\u003E\n\u003Ch3 id=\"jsonparse-jsonstringify\"\u003EJSON.parse(), JSON.stringify()\u003C\u002Fh3\u003E\n\u003Cp\u003EKiedy tworzymy klona, chcielibyśmy by był całkowicie \u003Cstrong\u003Eniezależny referencyjnie\u003C\u002Fstrong\u003E od oryginału, a jednocześnie był identyczny jak on. Łatwo można to uzyskać za pomocą niezbyt eleganckiej sztuczki z JSONem. Metoda ta działa tylko z \u003Cstrong\u003Estrukturami danych\u003C\u002Fstrong\u003E - obiekt w tym wypadku nie może zawierać funkcji. \u003C\u002Fp\u003E\n\u003Cp\u003EOsobiście \u003Cstrong\u003Enie stosowałabym\u003C\u002Fstrong\u003E tego sposobu - w przypadku gdy przy wstępnych założeniach obiekt jest zwykłą strukturą danych, a później nieświadomy inny programista dopisze do niego metody, pojawi się nieoczekiwany i problematyczny bug.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #000c18\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #9966B8\"\u003Evar\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E strawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    color: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'red'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    taste: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'sweet'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    size: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'large'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    shape: {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        x: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E10\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        y: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E32\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        z: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E33\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    }\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E};\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econst\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E someOtherStrawberry \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Eparse\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Estringify\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry));\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.size \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E'small'\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.size) \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: large, wszystko OK!  \u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #6688CC\"\u003EsomeOtherStrawberry.shape.x \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E32\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #9966B8\"\u003Econsole\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(strawberry.shape.x) \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F output: 10, wszystko OK!\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch3 id=\"customowa-funkcja-do-głębokiego-kopiowania\"\u003ECustomowa funkcja do głębokiego kopiowania\u003C\u002Fh3\u003E\n\u003Cp\u003EPosiadamy już narzędzia do tworzenia płytkich kopii, możemy więc je wykorzystać przy tworzeniu głębokich kopii, wystarczy \u003Cstrong\u003Erekurencyjnie\u003C\u002Fstrong\u003E przejść po wszystkich \u003Cstrong\u003Ewęzłach\u003C\u002Fstrong\u003E. \u003C\u002Fp\u003E\n\u003Cp\u003EAlgorytm sprawdza czy przekazana w argumencie wartość - jeśli jest \u003Cstrong\u003Eprymitywem\u003C\u002Fstrong\u003E, po prostu zwraca go. W przypadku, gdy argument jest \u003Cstrong\u003Eobiektem\u003C\u002Fstrong\u003E, przechodzimy po \u003Cstrong\u003Ekażdym\u003C\u002Fstrong\u003E jego \u003Cstrong\u003Epolu\u003C\u002Fstrong\u003E i sprawdzamy czy jest ono typem \u003Cstrong\u003Eprymitywnym\u003C\u002Fstrong\u003E, jeśli nie - wywołujemy funkcję \"rozbijającą\" dla pola nie-prymitywnego .\u003C\u002Fp\u003E\n\u003Cp\u003EWszystko się powtarza do momentu, gdy algorytm przejdzie po całym \u003Cstrong\u003Edrzewie\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cpre class=\"shiki\" style=\"background-color: #000c18\"\u003E\u003Ccode\u003E\u003Cspan style=\"color: #9966B8\"\u003Econst\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #DDBB88\"\u003EdeepCopyFunc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #2277FF\"\u003Echild\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003E=&gt;\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003Elet\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E parent, value, key\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E (\u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Etypeof\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E child \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E!==\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E\"object\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E||\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E child \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E===\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E) {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E child \u003C\u002Fspan\u003E\u003Cspan style=\"color: #223355\"\u003E\u002F\u002F zwracamy jeśli jest typem prymitywnym  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    }\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    parent \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #9966B8\"\u003EArray\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E.\u003C\u002Fspan\u003E\u003Cspan style=\"color: #DDBB88\"\u003EisArray\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(child) \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E?\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E [] \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E:\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {}\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #6688CC\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #223355\"\u003E\u002F\u002Fjeśli jest obiektem to iterujemy po każdym property  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Efor\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E (key \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Ein\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E child) {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        value \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E child[key]\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        \u003C\u002Fspan\u003E\u003Cspan style=\"color: #223355\"\u003E\u002F\u002Fjeśli wartość dla key jest obiektem to wykonujemy rekurencyjną kopie  \u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E (value \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E!==\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E&&\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Etypeof\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E value \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E===\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E\"object\"\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E) {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E            parent[key] \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E \u003C\u002Fspan\u003E\u003Cspan style=\"color: #DDBB88\"\u003EdeepCopyFunc\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E(value)\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        } \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Eelse\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E            parent[key] \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E value\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E        }\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    }\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E parent\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E}\u003C\u002Fspan\u003E\n\n\u003Cspan style=\"color: #9966B8\"\u003Elet\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E originalArray \u003C\u002Fspan\u003E\u003Cspan style=\"color: #225588\"\u003E=\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E [\u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E37\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E, \u003C\u002Fspan\u003E\u003Cspan style=\"color: #F280D0\"\u003E3700\u003C\u002Fspan\u003E\u003Cspan style=\"color: #6688CC\"\u003E, {\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E    hello: \u003C\u002Fspan\u003E\u003Cspan style=\"color: #22AA44\"\u003E\"world\"\u003C\u002Fspan\u003E\n\u003Cspan style=\"color: #6688CC\"\u003E}]\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EMyślę, że artykuł okazał się pomocny, a moje objaśnienia niezbyt trudne. Jeśli zauważysz gdzieś błąd, proszę, napisz do mnie. Zależy mi, by mój blog był rzetelnym źródłem informacji, więc z chęcią przyjmuję krytykę.\u003C\u002Fp\u003E\n","description":"Opisuję metody wykonywania klonów obiektów","timeToRead":4,"cover":"\u002Fimages\u002Fposts\u002Fkopie\u002Fcover.jpg","author":{"id":"Julia Glaszka","title":"Julia Glaszka"},"tags":[{"id":"javascript","title":"javascript","path":"\u002Ftag\u002Fjavascript\u002F"},{"id":"programowanie","title":"programowanie","path":"\u002Ftag\u002Fprogramowanie\u002F"}]},"recommendedposts":{"edges":[{"node":{"id":"5c6912511fbf00580160f309c8bff279","title":"Obiektywizm a rozwój w IT","path":"\u002Fobiektywizm-a-rozwoj-w-it\u002F","cover":"\u002Fimages\u002Fposts\u002Fobiektywizm\u002Fatlas.jpg"}},{"node":{"id":"507900b37c02db543d8fa26f4705fb1e","title":"Wykorzystaj cały potencjał klastra MongoDB z pomocą preferencji odczytu","path":"\u002Fwykorzystaj-caly-potencjal-klastra-mongo-db-z-pomoca-preferencji-odczytu\u002F","cover":"\u002Fimages\u002Fposts\u002Fmongodb-read-preferences\u002Froute.jpg"}},{"node":{"id":"c854d4a554f3e6aa74a421fac8beb243","title":"Konfiguracja ClusterSettings w MongoDB Java Driver","path":"\u002Fkonfiguracja-cluster-settings-w-mongo-db-java-driver\u002F","cover":"\u002Fimages\u002Fposts\u002Fcluster-settings-mongo\u002Flocal-threshold.png"}}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.6515d007.js" defer></script><script src="/assets/js/page--src--templates--post-vue.7bb06337.js" defer></script>
  </body>
</html>
